@page "/dashboard/orders"
@using CafeApp.Business.Helpers.Dtos
@using CafeApp.Shared.RestClient.Interfaces
@layout AdminLayout
@inject IApplicationUnit _unit;
@inject NavigationManager _navigation;
@inject IRestUnit _restUnit;
<MudIconButton OnClick=GoToCreatePAge Icon="@Icons.Material.Filled.Add" Title="جدید">افزودن</MudIconButton>
<MudIconButton OnClick=Sync Icon="@Icons.Material.Filled.Sync" Title="ارسال به سرور">ارسال به سرور</MudIconButton>


<MudDataGrid @ref="_dataGrid" Striped=true ServerData=LoadData T="OrderDto">

    <Columns>
        <PropertyColumn Title="زمان" Property="x=>x.Time"></PropertyColumn>
        <PropertyColumn Title="مشتری" Property="x=>x.Customer"></PropertyColumn>
        <PropertyColumn Title="   میز" Property="x=>x.Table"></PropertyColumn>
        <PropertyColumn Title="   مجموع کل" Property="x=>x.TotalPrice"></PropertyColumn>
        <TemplateColumn  >
            <CellTemplate>
                <MudStack Row>

                    <MudButtonGroup>
                        <MudButton Disabled="@GetStateButtonEnable(context.Item.State,"جدید")" Style="@GetChangeStateButtonStyle(context.Item.State,"جدید")" Color="Color.Surface"> جدید</MudButton>
                        <MudButton Onclick="()=>ChangeState(context.Item.Id,2)" Disabled="@GetStateButtonEnable(context.Item.State,"آماده سازی")" Style="@GetChangeStateButtonStyle(context.Item.State,"آماده سازی")" Color="Color.Surface">آماده سازی</MudButton>
                        <MudButton Onclick="()=>ChangeState(context.Item.Id,3)" Disabled="@GetStateButtonEnable(context.Item.State,"تحویل")" Style="@GetChangeStateButtonStyle(context.Item.State,"تحویل")" Color="Color.Surface">تحویل</MudButton>
                        <MudButton Disabled="true" Style="@GetChangeStateButtonStyle(context.Item.State,"تسویه شد")" Color="Color.Surface">تسویه شد</MudButton>

                        <MudButton Onclick="()=>ChangeState(context.Item.Id,0)" Disabled="@GetStateButtonEnable(context.Item.State,"لغو")" Style="@GetChangeStateButtonStyle(context.Item.State,"لغو")" Color="Color.Surface">لغو</MudButton>

                    </MudButtonGroup>
                    <MudButtonGroup>
                        <MudButton OnClick="()=>GoToDetails(context.Item.Id)" Style="background-color:forestgreen;margin:5px" Color="Color.Surface"> تسویه</MudButton>
                    </MudButtonGroup>
                </MudStack>
            </CellTemplate>
        </TemplateColumn>

        
       
    </Columns>

</MudDataGrid>


@code {
    private MudDataGrid<OrderDto> _dataGrid;


    private string IsActiveString(bool isActive)
    {
        if (isActive)
            return "فعال";
        else
            return "غیرفعال";
    }



}